<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
    <link rel="stylesheet" href="myStyle.css">
    <style>
        #map {
            position: absolute;
            height: 80%;
            top: 0px;
            bottom: 0px;
            left: 0px;
            right: 0px;
        }

        body {
            margin: 30px;
        }

        .my-row {
            border: 1px solid red;
            height: 50%;
        }

        .my-col {
            border: 3px solid red;
        }
    </style>
    <title> Project </title>
</head>
<body>
    <div class="container-fluid d-flex flex-column" style="border: 1px solid green; height: 700px;">
        <div class="row flex-fill" style="height: 100%;">
            <div class="col-8 my-col">
                <div class="row" style="border: 1px solid red; height: 80%;">
                    <div class="container">
                        <div id="map"> </div>
                    </div>
                </div>
                <div class="row" style="border: 1px solid red; height: 20%; ">
                    Flight Details
                </div>
            </div>
            <div class="col-4 my-col">
                <div class="row text-center my-row">
                    <form id="myForm" class="form" style="margin: auto">
                        <h5 style="text-align:center"> Add New Server</h5>
                        <div class="row">
                            <div class="col">
                                <div class="form-group">
                                    <label for="ServerId">ServerId</label>
                                    <input type="text" name="ServerId" id="ServerId" class="form-control" />
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label for="ServerURL">ServerURL</label>
                                    <input type="text" name="ServerURL" id="ServerURL" class="form-control" />
                                </div>
                            </div>
                        </div>
                        <button type="submit">Add Server</button>
                    </form>
                    <table class="table table-responsive table-hover" id="tblServer">
                        <thead>
                            <tr>
                                <th>ServerID</th>
                                <th>ServerURL</th>
                            </tr>
                        </thead>

                    </table>
                </div>
                <div class="row my-row">
                    <h4 class="text-center">External Flights</h4>


                    <table class="table table-responsive table-hover" id="externalFlightsTbl">
                        <thead>
                            <tr>
                                <th>Flight ID</th>
                                <th>Arrival Time</th>
                                <th>Airline</th>
                            </tr>
                        </thead>
                        <tbody id="externalFlightsBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Send Data of Server Scrip-->
    <script>
        var formData = JSON.stringify($("#myForm").serializeArray());
        $.ajax({
            type: "POST",
            url: "../api/servers",
            data: formData,
            success: function () { console.log("Sucsses!") },
            dataType: "json",
            contentType: "application/json"
        });
    </script>

    <!--Mao Scripts-->
    <script>
        var map = L.map('map').setView([0, 0], 1);
        L.tileLayer('https://api.maptiler.com/maps/hybrid/{z}/{x}/{y}.jpg?key=z9JRmQouqskUAwB0autN', {
            attribution: '<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>',
        }).addTo(map);
        var leafletIcon = L.icon({
            iconUrl: 'https://img.icons8.com/color/48/000000/penis.png',
            shadowUrl: 'https://leafletjs.com/examples/custom-icons/leaf-shadow.png',
            iconSize: [48, 60],
            iconAnchor: [22, 94],
            shadowAnchor: [4, 62],
            popupAnchor: [12, -90]
        })
        var marker = L.marker([51.5, -0.09], { icon: leafletIcon }).addTo(map);
        var circle = L.circle([51.508, -0.11], {
            color: 'red',
            fillColor: '#f03',
            fillOpacity: 0.5,
            radius: 500
        }).addTo(map);
        circle.bindPopup("<b> Hey Michael!</b><br> Im a Circle MotherFucker!").openPopup();
        marker.bindPopup("<b> Hey Michael!</b><br> Im a Dick Marker MotherFucker!").openPopup();
    </script>

    <!-- Getting Server Data From Server And Add It To Table Script-->
    <script src="../Scripts/jquery.min.js"></script>
    <script>
        var url = "../api/Servers";
        $.getJSON(url, function (data) {
            console.log(data);
            data.forEach(function (server) {
                $("#tblServer").append("<tr><td>" + server.serverID + "</td>" + "<td>" + server.serverURL + "</td></tr>");
            });
        });
    </script>

</body>
</html>